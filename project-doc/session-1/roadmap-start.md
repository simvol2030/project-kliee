# Roadmap Session-1: CMS Admin Panels

**Версия:** START
**Дата:** 2026-01-08
**Автор:** CLI (Планировщик)
**Статус:** Готово для Developer

---

## Обзор сессии

**Цель:** Создать полноценные админки для всех основных разделов сайта K-Liée с миграцией данных из JSON в SQLite.

**Общий паттерн для всех changes:**
- Миграция данных из JSON → SQLite
- Создание/доработка админки с CRUD
- Мультиязычность: 4 языка (EN/RU/ES/ZH)
- Оптимизация изображений: webp, 1500x1500px, 80-85%
- Без дублирования файлов (проверка по хэшу)
- Сохранение работы светлой/тёмной темы

---

## Changes (5 штук)

### 1. changes-1-shop-modul
**Приоритет:** HIGH
**Спецификация:** `changes-1-shop-modul/spec-final.md`

**Суть:** Доработка Shop — редактирование товаров, multi-image галерея, видео.

**Ключевые задачи:**
- Исправить загрузку медиа (не сохраняются изображения)
- Multi-image галерея для товаров (главное + дополнительные)
- Поддержка видео для товаров
- Сортировка изображений в галерее
- Без дублирования при загрузке

**Зависимости:** Нет

---

### 2. changes-2-work
**Приоритет:** HIGH
**Спецификация:** `changes-2-work/spec-final.md`

**Суть:** Works — управление коллекциями/сериями через админку.

**Ключевые задачи:**
- Таблица `series` в БД (миграция из JSON)
- Админка для управления сериями
- CRUD для серий с мультиязычностью
- Привязка artworks к сериям
- Без дублирования изображений

**Зависимости:** Нет

---

### 3. changes-3-Exhibitions
**Приоритет:** MEDIUM
**Спецификация:** `changes-3-Exhibitions/spec-final.md`

**Суть:** Exhibitions — полноценное управление выставками.

**Ключевые задачи:**
- Доработать таблицу `exhibitions` (добавить поля)
- Галерея изображений для выставок
- Миграция данных из JSON
- CRUD в админке
- Оптимизация в webp

**Зависимости:** Нет

---

### 4. changes-4-nft
**Приоритет:** MEDIUM
**Спецификация:** `changes-4-nft/spec-final.md`

**Суть:** NFT — полноценное управление NFT коллекцией.

**Ключевые задачи:**
- Создать таблицу `nfts` в БД
- Админка NFT с CRUD
- **ОБЯЗАТЕЛЬНЫЕ поля:** изображение, видео, описание (4 языка)
- Страница отдельного NFT `/[lang]/nft/[slug]`
- Миграция 5 NFT из спарсенных данных
- Перевод описаний на RU/ES/ZH
- Загрузка видео (mp4, webm, до 50MB)

**Зависимости:** Нет

**Данные для миграции:** `project/nft/nft.md` + видео `_1_.mp4` ... `_5_.mp4`

---

### 5. changes-5-about
**Приоритет:** MEDIUM
**Спецификация:** `changes-5-about/spec-final.md`

**Суть:** About — редактирование через админку.

**Ключевые задачи:**
- Создать таблицы: `about_artist`, `about_education`, `about_awards`, `about_residencies`
- Миграция из `data/about.json`
- Админка About с CRUD для всех секций
- Загрузка/замена изображения художника
- Биография и SEO на 4 языках

**Зависимости:** Нет

---

## Рекомендуемый порядок выполнения

```
1. changes-1-shop-modul  ← Исправить загрузку медиа (критично)
2. changes-2-work        ← Серии/коллекции
3. changes-3-Exhibitions ← Выставки
4. changes-4-nft         ← NFT (новая таблица + видео)
5. changes-5-about       ← About (4 новые таблицы)
```

**Почему такой порядок:**
- Shop первым — там баг с загрузкой медиа, который может влиять на другие разделы
- Work и Exhibitions — доработка существующего
- NFT и About — создание с нуля (больше работы)

---

## Технические требования (общие)

### База данных
- Drizzle ORM + SQLite
- Миграции через `npx drizzle-kit push`
- Проверить schema.ts после каждого change

### Изображения
- Оптимизация в webp при загрузке
- Максимум 1500x1500px
- Качество 80-85%
- Проверка по хэшу (без дублирования)
- Хранение: `/static/uploads/`

### Видео (только NFT)
- Форматы: mp4, webm
- Максимум 50MB
- Хранение: `/static/uploads/nft/videos/`

### Мультиязычность
- 4 языка: EN, RU, ES, ZH
- Все текстовые поля на всех языках
- Провайдеры должны возвращать данные по текущему языку

### Админка
- Путь: `/about`, `/nft`, etc. (внутри `(admin)` group)
- Server actions для CRUD
- Валидация обязательных полей
- Toast уведомления

---

## Проверка после каждого change

```bash
# TypeScript
npm run check

# Build
npm run build

# Drizzle миграции
npx drizzle-kit push
```

---

## Файлы для Developer

| Change | Спецификация |
|--------|--------------|
| changes-1-shop-modul | `changes-1-shop-modul/spec-final.md` |
| changes-2-work | `changes-2-work/spec-final.md` |
| changes-3-Exhibitions | `changes-3-Exhibitions/spec-final.md` |
| changes-4-nft | `changes-4-nft/spec-final.md` |
| changes-5-about | `changes-5-about/spec-final.md` |

---

## Промт для Developer (Claude Code Web)

```
Прочитай CLAUDE.md, CLAUDE.web.md, project-doc/session-1/.
Начни с ФАЗЫ 2 (Research → Tech-spec → Plan → Roadmap-final).
Выполняй changes в порядке из roadmap-start.md.
```

---

*START — передаётся Developer для Research и реализации*
